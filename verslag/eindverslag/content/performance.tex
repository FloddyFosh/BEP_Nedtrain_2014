\section{Performance}
Om de gebruikte oplossingsmethoden te verantwoorden, zullen deze in dit hoofdstuk vergeleken worden met andere mogelijke methoden. Zowel de looptijd van het oplossen van verschillende probleeminstanties zal geanalyseerd worden als de flexibiliteit die met verschillende methodes bereikt wordt.

\subsection{Looptijd}
TODO: Looptijd van interior point en update bestaande tabellen want blijkbaar stond debug aan.

In dit hoofdstuk een analyse van de looptijd van de solver. Bij deze analyse delen we de solver op in vijf belangrijke delen: parsen, STJN, ESTA$^+$, chaining en LP. Om de looptijd te bepalen gebruiken we een grote probleeminstantie genaamd 'xxl-instance'. Deze probleeminstantie bestaat uit:
\begin{itemize}
    \item 10 resources, met elk 1 resource unit
    \item 180 projecten, met elk tussen de 4 en de 6 activiteiten
    \item 912 activiteiten, die elk gebruik maken van tussen de 1 en 5 resources
\end{itemize}

In de Tabellen \ref{tbl:xxl+output}, \ref{tbl:xxl-output} en \ref{tbl:xxl+outputbestand} is te zien wat de looptijden zijn van de onderdelen van de solver met en zonder printen van output. Deze waarden komen van een getrimd gemiddelde van 20 metingen. De solver stuurt de output naar \texttt{stdout} Als er wel output wordt geprint duurt het oplossen van de 'xxl-instance' iets minder dan $110$ seconden en als er geen output wordt geprint duurt het oplossen ongeveer $1,4$ seconden. Ook valt op dat als alle output niet naar \texttt{stdout}, maar naar een bestand wordt gestuurd de totale looptijd iets minder dan $4$ seconden duurt. Er valt dus veel snelheidswinst te behalen door het printen te optimaliseren. Een andere optie is om slimmer om te gaan met wat er wel en niet wordt geprint, want dat kan ook al veel tijd schelen. Een mogelijkheid is om niet telkens alle informatie van een nieuw frame te printen, maar alleen het verschil met het vorige frame. Een andere mogelijkheid is om niet met een apparte solver te werken die wordt aangeroepen door de NedTrain Planner, maar de solver te integreren in de NedTrain Planner. Dan hoeft er niets te worden uitgeprint, maar dit heeft wel als nadeel dat er dan niet gemakkelijk een nieuwe solver toegevoegd kan worden aan de NedTrain Planner. Daarom is printen naar een tijdelijk bestand in plaats van \texttt{stdout} mogelijk een goed alternatief om voor een versnelling te kunnen zorgen. 

\begin{table}[H]
\parbox{.45\linewidth}{
    \centering
    \begin{tabular}{| l | r | r |}
        \hline
                    & Looptijd ($s$)  & Percentage ($\%$) \\
        \hline
        Parsing     & $0.010927$      & $0.0$   \\
        STJN        & $0.002788$      & $0.0$   \\
        ESTA$^+$    & $108.299420$    & $99.2$  \\
        Chaining    & $0.565354$      & $0.5$   \\
        LP          & $0.319607$      & $0.3$   \\
        \hline \hline
        Totaal      & $109.198681$    & $100.0$ \\
        \hline
    \end{tabular}
    \caption{xxl-instance met output}
    \label{tbl:xxl+output}
}
\hfill
\parbox{.45\linewidth}{
    \centering
    \begin{tabular}{| l | r | r |}
        \hline
                    & Looptijd ($s$)& Percentage ($\%$) \\
        \hline
        Parsing     & $0.010247$      & $0.7$   \\
        STJN        & $0.002798$      & $0.2$   \\
        ESTA$^+$    & $1.092032$      & $76.5$  \\
        Chaining    & $0.037414$      & $2.6$   \\
        LP          & $0.283970$      & $19.9$  \\
        \hline \hline
        Totaal      & $1.426638$      & $100.0$ \\
        \hline
    \end{tabular}
    \caption{xxl-instance zonder output}
    \label{tbl:xxl-output}
}
\end{table}

\begin{table}[H]
    \centering
    \begin{tabular}{| l | r | r|}
        \hline
                    & Looptijd ($s$)& Percentage ($\%$) \\
        \hline
        
        Parsing     & $0.009044$    & $0.2$     \\
        STJN        & $0.002736$    & $0.1$     \\
        ESTA$^+$    & $3.362071$    & $88.0$    \\
        Chaining    & $0.159881$    & $4.2$     \\
        LP          & $0.288064$    & $7.5$     \\
        \hline \hline
        Totaal      & $3.822129$    & $100.0$   \\
        \hline
    \end{tabular}
    \caption{xxl-instance en output naar bestand}
    \label{tbl:xxl+outputbestand}
\end{table}

\subsection{Flexibiliteit}
De verdeling van de flexibiliteit over alle activiteiten kan gemeten worden met de \emph{Mean Squared Error} (MSE) van de flexibiliteit $MSE(flex)$ die staat gedefinieerd in Formule \ref{eq:mse}. Hoe lager deze MSE is hoe beter de flexibiliteit is verdeeld over de activiteiten.

\begin{align}
\label{eq:mse}
\begin{aligned}
    flex_{gem} =& \sum_{t \in T} \frac{t^+ - t^-}{|T|}      & \text{met } |T| \text{ het aantal elementen in } T\\
    MSE(flex) =& \sum_{t \in T} (flex_t - flex_{gem})^2     & \\
               =& \sum_{t \in T} (t^+ - t^- - flex_{gem})^2 & \\
\end{aligned}
\end{align}

Er is met $2040$ probleeminstanties getest welke van de vier methodes de beste verdeling van flexibiliteit geeft en welke de grootste totale flexibiliteit heeft. In Tabel \ref{tbl:performanceflexver} en \ref{tbl:performanceflextot} worden telkens twee methoden vergeleken en aangegen in hoeveel procent van de gevallen de 'rij' beter is dan de 'kolom'. Waarbij de Interior Point methode wordt afgekort tot IP en de Simplex methode wordt afgekort tot S. Met subscript $1$ wordt het gebruik van LP-probleem in Formule \ref{eq:flexLP} aangeduid. Met subscript $2$ wordt het gebruik van LP-probleem in de Formules \ref{eq:flexfirstLP} en \ref{eq:flexsecondLP} aangeduid.

\begin{table}[H]
\parbox{.45\linewidth}{
    \centering
    \begin{tabular}{| c | r | r | r | r |}
        \hline
            & \midden{IP$_1$} & \midden{IP$_2$} & \midden{S$_1$} & \midden{S$_2$} \\
        \hline
        IP$_1$ & \midden{$\times$} & $0,0$ & $88,5$ & $0,5$ \\
        IP$_2$ & $99,9$ & \midden{$\times$} & $100,0$ & $88,9$ \\ 
        S$_1$  & $10,5$ & $0,0$ & \midden{$\times$} & $0,1$ \\
        S$_2$  & $99,4$ & $10,7$ & $99,9$ & \midden{$\times$} \\
        \hline
    \end{tabular}
    \caption{Vergelijking verdeling flexibiliteit}
    \label{tbl:performanceflexver}
}
\hfill
\parbox{.45\linewidth}{
    \centering
    \begin{tabular}{| c | r | r | r | r |}
        \hline
            & \midden{IP$_1$} & \midden{IP$_2$} & \midden{S$_1$} & \midden{S$_2$} \\
        \hline
        IP$_1$ & \midden{$\times$} & $-$ & $-$ & $-$ \\
        IP$_2$ & $-$ & \midden{$\times$} & $-$ & $-$ \\ 
        S$_1$  & $-$ & $-$ & \midden{$\times$} & $-$ \\
        S$_2$  & $-$ & $-$ & $-$ & \midden{$\times$} \\
        \hline
    \end{tabular}
    \caption{Vergelijking totale flexibiliteit}
    \label{tbl:performanceflextot}
}
\end{table}

Met behulp van Tabel \ref{tbl:performanceflexver} waar de verdeling van flexibiliteit gemeten is met Formule \label{eq:mse} kan worden bepaald welke methode de beste verdeling van flexibiliteit heeft. Dus IP$_2$ heeft de beste verdeling van flexibiliteit, daarna komen van hoog naar laag S$_2$, IP$_1$ en S$_1$. 

\subsection{Chaining}
TODO: Hier komt nog een analyse van de verschillende methodes van chaining om een chain te selecteren. 
